<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MoonLight - Editor</title>
    <link rel="stylesheet" href="<%= urlFor('assets/css/editor.css') %>">
    <link rel="stylesheet" href="<%= urlFor('assets/css/topbar.css') %>">
</head>
<body>

<!-- Topbar -->
<nav class="topnav">
    <div class="topbar">
        <img src="app://assets/iconcircle2.png" class="icon" alt="App Icon">
        <div class="topbar-buttons">
            <p><u>F</u>ile</p>
            <p><u>E</u>dit</p>
            <p><u>V</u>iew</p>
            <p><u>H</u>elp</p>
        </div>
        <p class="project-name">MyProject</p>
    </div>
    <div class="topbar-right">
        <div class="toolbar-group">
            <button title="Run"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z" /></svg></button>
            <button title="Settings"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.24-.438.613-.438.995s.145.755.438.995l1.003.827c.424.35.534.954.26 1.431l-1.296 2.247a1.125 1.125 0 0 1-1.37.49l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 0 1-.22.128c-.332.183-.582.495-.645.87l-.213 1.28c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.645-.87a6.52 6.52 0 0 1-.22-.127c-.324-.196-.72-.257-1.075-.124l-1.217.456a1.125 1.125 0 0 1-1.37-.49l-1.296-2.247a1.125 1.125 0 0 1 .26-1.431l1.296-2.247a1.125 1.125 0 0 1 1.37-.49l1.217.456c.355.133.75.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.645-.87l.213-1.281z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0z" /></svg></button>
        </div>
        <div class="window-controls">
            <button id="min-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14"/></svg></button>
            <button id="max-btn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M4 4h16v16H4z" fill="none" stroke="currentColor" stroke-width="2"/></svg></button>
            <button id="close-btn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="22" height="22"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/></svg></button>
        </div>
    </div>
</nav>

<!-- Main IDE Body -->
<div class="ide-body">
    <div class="tool-bar left">
        <div class="tool-group-top">
            <button class="tool-window-button active" data-target="#project-panel" data-position="left">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z" /></svg>
            </button>
        </div>
        <div class="tool-group-bottom">
            <button class="tool-window-button" data-target="#problems-panel" data-position="bottom">
                 <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
            </button>
            <button class="tool-window-button" data-target="#output-panel" data-position="bottom">
                 <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" /></svg>
            </button>
        </div>
    </div>

    <div class="main-content-grid">
        <div id="project-panel" class="side-panel">
            <div class="panel-header"><h3>Project</h3></div>
            <ul class="file-list">
                <!-- File structure here -->
            </ul>
        </div>
        <div class="editor-container">
            <div class="editor-group">
                <div class="tabs">
                    <div class="tab active"><span>ServerScript</span><button class="close-tab">Ã—</button></div>
                </div>
                <div class="editor-area">
                    <div class="code-editor"><textarea>print("Hello, world!")</textarea></div>
                </div>
            </div>
        </div>
        <div id="problems-panel" class="bottom-panel is-hidden">
            <div class="panel-header"><h3>Problems</h3></div>
            <p>No problems have been detected.</p>
        </div>
        <div id="output-panel" class="bottom-panel is-hidden">
            <div class="panel-header"><h3>Output</h3></div>
            <p>Output will appear here.</p>
        </div>
    </div>

    <div class="tool-bar right">
        <!-- Right-side buttons go here -->
    </div>
</div>

<!-- Status Bar -->
<div class="statusbar">
    <div class="breadcrumb"><span>MyProject > Workspace > ServerScript</span></div>
    <div class="right"><span>Ln 1, Col 1</span><span>Spaces: 4</span><span>UTF-8</span></div>
</div>

<script>
    document.getElementById('min-btn').addEventListener('click', () => window.moonlight.minimize());
    document.getElementById('max-btn').addEventListener('click', () => window.moonlight.maximize());
    document.getElementById('close-btn').addEventListener('click', () => window.moonlight.close());

    document.querySelectorAll('.tool-window-button').forEach(button => {
        button.addEventListener('click', () => {
            const targetPanel = document.querySelector(button.dataset.target);
            if (targetPanel) {
                const isActive = button.classList.contains('active');

                document.querySelectorAll(`.tool-window-button[data-position="${button.dataset.position}"]`).forEach(b => {
                    if (b !== button) {
                        b.classList.remove('active');
                        document.querySelector(b.dataset.target).classList.add('is-hidden');
                    }
                });

                targetPanel.classList.toggle('is-hidden');
                button.classList.toggle('active');
            }
        });
    });
</script>
